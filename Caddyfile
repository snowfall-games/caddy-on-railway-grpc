{
	auto_https off
}

horde.snowfall.games {
	# Add health check/debug endpoint
	handle /health {
		respond "Caddy is working" 200
	}

	# gRPC
	@grpc header_regexp grpc Content-Type ^application/grpc
	reverse_proxy @grpc snowfall-horde:5002 {
		transport http { 
			versions 2c 
		}
	}

	# Fallback HTTP
	reverse_proxy snowfall-horde:5000
}