{
	auto_https off
}

horde.snowfall.games {
	# gRPC
	@grpc header_regexp grpc Content-Type ^application/grpc
	reverse_proxy @grpc ${HORDE_GRPC_SERVICE_URL} {
		transport http { 
			versions 2c 
		}
		header_up X-Forwarded-Host {host}
		header_up X-Forwarded-Proto {scheme}
	}

	# Fallback HTTP
	reverse_proxy ${HORDE_SERVICE_URL} {
		header_up X-Forwarded-Host {host}
		header_up X-Forwarded-Proto {scheme}
	}
}